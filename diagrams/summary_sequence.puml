@startuml SummarySequence
!theme spacelab

title Sequence: GET /summary/{user_id}

actor Client
participant "main.py\n(Router)" as Router
participant "logic.py\n(Business Logic)" as Logic
database "Database" as DB

Client -> Router: GET /summary/123?start_date=...&end_date=...
activate Router

alt Invalid Date Range
    Router -> Router: Validate dates (start_date > end_date)
    Router --> Client: HTTP 400 Bad Request
else Valid Request
    Router -> Logic: calc_summary_stats(db, user_id, dates)
    activate Logic

    Logic -> DB: SELECT MAX(...), MIN(...), AVG(...) etc.\nFROM transactions WHERE user_id = 123 AND ...
    activate DB
    DB --> Logic: Return summary statistics
    deactivate DB

    alt No Transactions Found
        Logic -> Logic: Check if results are empty
        Logic -->> Router: raise NoTransactionsFoundError
        Router --> Client: HTTP 404 Not Found
    else Transactions Found
        Logic -> Logic: Create SummaryData object
        Logic --> Router: Return SummaryData object
        deactivate Logic

        Router --> Client: HTTP 200 OK with JSON body
    end
end

deactivate Router

@enduml